<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="/stylesheets/base.css">
	<link rel="stylesheet" href="/stylesheets/layout.css">
	<link rel="stylesheet" href="/stylesheets/module.css">
	<link rel="stylesheet" href="/stylesheets/theme.css">
	<title>Gezzo?</title>
</head>
<body>
	<!-- TODO: Remove Ember.Select once all the pages are complete, and the page are bound to each other -->
	<!-- TODO: There are some inline avatar images shown. They need to come from the controllers -->
	<!-- TODO: Need a home button in design -->
	<script type="text/x-handlebars" data-template-name="application">
		{{view Ember.Select 
			id="test-users-select"
			content=usertokens
			value=token
			class="l-fill-width"}}
		{{outlet}}
		{{outlet modal}}
	</script>

	<script type="text/x-handlebars" data-template-name="user/view">
		<ul class="l-two-col-list l-clearfix">
			{{#each itemController='gameItem'}}
				<li>
					<div class="character-game-item l-fill-parent" {{action "select"}}>
						<div class="l-fill-parent">
							<p class="overlay l-fill-parent">Play</p>
							<img src="http://placehold.it/214x317" alt="person">
							<div class="info l-anchor-bottom">
								<h2 class="name">{{username}}</h2>
								<p class="">{{turn}}</p>
								<p class="date">{{date}}</p>
							</div>
						</div>
					</div>
				</li>
			{{/each}}
				<li>
					<div class="character-game-item l-fill-parent" {{action "newgame"}}>
						<div class="l-fill-parent new-game-item">
							<p>+</p>
						</div>
					</div>
				</li>
		</ul>
	</script>

	<script type="text/x-handlebars" data-template-name="game/select">
		<ul class="l-two-col-list l-clearfix">
			{{#each characters itemController='characterItem'}}
			<li>
				<div class="character-game-item l-fill-parent">
					<div class="l-fill-parent">
						<img {{bind-attr src=img}} alt="person">
						<div class="controls l-anchor-bottom">
							<h2 class="name info">{{name}}</h2>

							{{#if isUserSelection}}
							<div class="l-inline-list l-clearfix">
								<p class="control l-inline l-100p" {{action "select"}}>Select</p>
							</div>
							{{/if}}

						</div>
					</div>
				</div>
			</li>
			{{/each}}
		</ul>
	</script>

	<!-- TODO: You need to hide the 'guess' button if the character is flipped -->
	<script type="text/x-handlebars" data-template-name="game/board">
		<ul class="view-controls l-two-col-list l-clearfix">
			<li {{action 'board'}}>Board</li>
			<li {{action 'question'}}>Questions</li>
		</ul>

		<ul class="spacer l-two-col-list l-clearfix">
			<li {{bind-attr class=viewBoard:active}}></li>
			<li {{bind-attr class=viewBoard::active}}></li>
		</ul>

		{{#if viewBoard}}
			{{#with lastaction}}
			<div class="comments">
				{{#with me}}
				<div class="comment-wrapper">
					<div class="my-comment comment l-align-right l-clearfix">
						<img class="l-20p l-inline" {{bind-attr src=avatar}} alt="avatar">
						<div class="l-80p l-inline info">
							<p><span>You</span> asked:</p>
							<p class="text">{{value}}</p>
						</div>
					</div>
				</div>
				{{/with}}
				{{#with opponent}}
				<div class="comment-wrapper">
					<div class="comment l-two-col-list l-clearfix">
						<img class="l-20p l-inline" {{bind-attr src=avatar}} alt="avatar">
						<div class="l-80p l-inline info">
							<p><span>{{name}}</span> replied:</p>
							<p class="text">{{value}}</p>
						</div>
					</div>
				</div>
				{{/with}}
			</div>
			{{/with}}

			<ul class="l-two-col-list l-clearfix">
				{{#each board itemController='characterItem'}}
				<li>
					<div class="character-game-item l-fill-parent">
						<div class="l-fill-parent">
							<img {{bind-attr src=img}} alt="person">
							<div class="controls l-anchor-bottom">
								<h2 class="name info">{{name}}</h2>
								{{#if isUserAction}}
								<div class="l-inline-list l-clearfix">
									{{#if up}}
										<p {{bind-attr class=":control :l-inline up:l-50p:l-0p"}} {{action "guess"}}>Guess</p>
									{{/if}}
									<p {{bind-attr class=":control :l-inline up:l-50p:l-100p"}} {{action "flip"}}>Flip</p>
								</div>
								{{/if}}
							</div>
						</div>
					</div>
				</li>
				{{/each}}
			</ul>
		{{else}}
			{{#each allactions itemController='actionItem'}}
			<div class="comments">
				{{#if isAction}}
					{{#with me}}
					<div class="comment-wrapper">
						<div class="my-comment comment l-align-right l-clearfix">
							<img class="l-20p l-inline" {{bind-attr src=avatar}} alt="avatar">
							<div class="l-80p l-inline info">
								<p><span>You</span> asked:</p>
								<p class="text">{{value}}</p>
							</div>
						</div>
					</div>
					{{/with}}

					{{#with opponent}}
					<div class="comment-wrapper">
						<div class="comment l-two-col-list l-clearfix">
							<img class="l-20p l-inline" {{bind-attr src=avatar}} alt="avatar">
							<div class="l-80p l-inline info">
								<p><span>{{name}}</span> replied:</p>
								<p class="text">{{value}}</p>
							</div>
						</div>
					</div>
					{{/with}}
				{{/if}}
			</div>
			{{else}}
				<div class="comments">
					<div class="comment-wrapper">
						<p class='l-text-center empty'>Nothing here yet..</p>
					</div>
				</div>
			{{/each}}

			{{#if isUserAction}}
			<div class="comments">
				<div class="comment-wrapper">
					<div class="my-comment comment l-align-right l-clearfix">
						<img class="l-20p l-inline" src="http://placehold.it/64x64" alt="avatar">
						<div class="l-80p l-inline">
							<div class="input">
								<form class="" {{action ask on="submit"}}>
									{{input class="l-fill-parent" type="text" placeholder="Ask a question..." value=userquestion}}
									{{input class="l-fill-parent" type="submit" value="Submit"}}
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>	
			{{/if}}
		{{/if}}
	</script>

	<!-- TODO: Missing 'start new game with this person' -->
	<script type="text/x-handlebars" data-template-name="game/reply">
	{{#each allactions itemController='replyItem'}}
		{{#if isAction}}
		<div class="comments">
			{{#with opponent}}
			<div class="comment-wrapper">
				<div class="comment l-two-col-list l-clearfix">
					<img class="l-20p l-inline" {{bind-attr src=avatar}} alt="avatar">
					<div class="l-80p l-inline info">
						<p><span>{{name}}</span> asked:</p>
						<p class="text">{{value}}</p>
					</div>
				</div>
			</div>
			{{/with}}
			{{#with me}}
			<div class="comment-wrapper">
				<div class="my-comment comment l-align-right l-clearfix">
					<img class="l-20p l-inline" {{bind-attr src=avatar}} alt="avatar">
					<div class="l-80p l-inline info">
						<p><span>You</span> replied:</p>
						<p class="text">{{value}}</p>
					</div>
				</div>
			</div>
			{{else}}
			<div class="comment-wrapper">
				<div class="my-comment comment l-align-right l-clearfix">
					<img class="l-20p l-inline" src="http://placehold.it/64x64" alt="avatar">
					<div class="l-80p l-inline">
						<div class="input">
							<form class="" {{action reply on="submit"}}>
								{{input class="l-fill-parent" type="text" placeholder="Reply..." value=userreply}}
								{{input class="l-fill-parent" type="submit" value="Submit"}}
							</form>
						</div>
					</div>
				</div>
			</div>	
			{{/with}}
		</div>
		{{else}}
			<div>guess</div>
		{{/if}}
	{{else}}
		<div class="comments">
			<div class="comment-wrapper">
				<p class='l-text-center empty'>Nothing here yet..</p>
			</div>
		</div>
	{{/each}}
	</script>

	<script type="text/x-handlebars" id="components/modal-dialog">
		<div class="overlay">
			{{yield}}
		</div>
	</script>

	<script type="text/x-handlebars" data-template-name="new/game/modal">
		{{#modal-dialog}}
			<div class="dialog">
				<h2>Creating a new game</h2>
				<p>Hang in there... we just gotta find you someone to play with. Then youll get to pick your character.</p>
			</div>
		{{/modal-dialog}}
	</script>

	<script type="text/x-handlebars" data-template-name="select/modal">
		{{#modal-dialog}}
			<div class="dialog">
				<h2>Saving...</h2>
				<p>Ok, just saving your selection to the cloud! After this, you will have to wait for your friend to play</p>
			</div>
		{{/modal-dialog}}
	</script>

	<script type="text/x-handlebars" data-template-name="guess/modal">
		{{#modal-dialog}}
			<div class="dialog">
				<h2>Checking...</h2>
				<p>Verifying if your guess is the right one... Just gimme a sec</p>
			</div>
		{{/modal-dialog}}
	</script>

	<script type="text/x-handlebars" data-template-name="ask/modal">
		{{#modal-dialog}}
			<div class="dialog">
				<h2>Asking...</h2>
				<p>Alright, Ill ask your friend your question. Hopefully they give you an answer that will help.</p>
			</div>
		{{/modal-dialog}}
	</script>

	<script type="text/x-handlebars" data-template-name="reply/modal">
		{{#modal-dialog}}
			<h3 {{action close}}>Reply Modal</h5>
		{{/modal-dialog}}
	</script>

	<script src="/javascripts/underscore.js"></script>
	<script src="/javascripts/moment.js"></script>	
	<script src="/javascripts/jquery-1.10.2.js"></script>
	<script src="/javascripts/handlebars-1.1.2.js"></script>
	<script src="/javascripts/ember-1.3.1.js"></script>
	<script src="/javascripts/app.js"></script>
</body>
</html>